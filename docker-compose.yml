version: "3"

services:
    server:
        build: ./server
        image: sjryall/node-server
        expose: 
            - ${APP_SERVER_PORT}
        environment:
            - API_HOST=${API_HOST}
            - APP_SERVER_PORT=${APP_SERVER_PORT}
            - NODE_ENV=production
        #volumes:
           # - ./srv/app/test-app-server/node_modules
           # - ./server:/srv/app/test-app-server
        ports:
            - ${APP_SERVER_PORT}:${APP_SERVER_PORT}

        command: npm run dev-server
    src:
        build: ./src
        image: sjryall/node-src
        environment: 
            - REACT_APP_PORT=${REACT_APP_PORT}
        #volumes:
            #- ./srv/app/test-app-src/node_modules
           # - ./src:/srv/app/test-app-src
        expose: 
            - ${REACT_APP_PORT}
        ports:
            - ${REACT_APP_PORT}:${REACT_APP_PORT}
        links: 
            - server
        command: npm run dev-client
